<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="orientation" content="landscape">
    <title>Clone do Snake.io</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #33ff33;
            --background-color: #121212;
            --container-bg: #1a1a1a;
            --border-color: #4a4a4a;
        }
        body {
            font-family: 'Press Start 2P', cursive;
            background-color: var(--background-color);
            color: #ffffff;
            margin: 0;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .game-wrapper {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }
        .game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        canvas#gameCanvas {
            background: linear-gradient(45deg, #0a0a0a, #1a1a1a);
            width: 100vw;
            height: 100vh;
            object-fit: cover;
        }
        .ui-element {
            position: absolute;
            transition: opacity 0.3s ease;
        }
        .ui-panel {
            top: 0.5rem;
            left: 0.5rem;
            font-size: clamp(0.6rem, 1.2vw, 0.8rem);
            z-index: 100;
            background: rgba(0, 0, 0, 0.6);
            padding: 0.3rem 0.6rem;
            border-radius: 5px;
        }
        #leaderboard {
            top: 0.5rem;
            right: 0.5rem;
            background-color: rgba(0, 0, 0, 0.6);
            border-radius: 5px;
            padding: 0.5rem;
            font-size: clamp(0.5rem, 1vw, 0.7rem);
            width: clamp(120px, 15vw, 180px);
            color: #ccc;
            z-index: 100;
        }
        #leaderboard h3 {
            margin: 0 0 0.5rem 0;
            color: var(--primary-color);
            text-align: center;
            font-size: clamp(0.6rem, 1.5vw, 0.8rem);
        }
        #leaderboard ol { margin: 0; padding: 0; list-style-type: none; }
        #leaderboard li { display: flex; justify-content: space-between; margin-bottom: 0.3rem; }
        #leaderboard li span:first-child { font-weight: bold; color: #fff; }
        
        .message-box {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.85);
            padding: 1.5rem;
            border-radius: 10px;
            border: 2px solid var(--primary-color);
            text-align: center;
            z-index: 200;
            width: 80%;
            max-width: 350px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            font-size: clamp(0.8rem, 2vw, 1rem);
        }
        .message-box.hidden { display: none; }
        #orientation-message {
            display: none; /* Controlado por JS */
            z-index: 300;
        }
        .mobile-controls {
            display: none; /* Controlado por JS */
        }
        #joystick-controls {
            position: absolute;
            bottom: 1.5rem;
            left: 1.5rem;
            z-index: 100;
        }
        #boost-controls {
            position: absolute;
            bottom: 1.5rem;
            right: 1.5rem;
            z-index: 100;
        }
        #joystick-area {
            width: clamp(80px, 15vw, 120px);
            height: clamp(80px, 15vw, 120px);
            background: rgba(55, 65, 81, 0.5);
            border-radius: 50%;
            position: relative;
            touch-action: none;
        }
        #joystick {
            width: clamp(35px, 6vw, 50px);
            height: clamp(35px, 6vw, 50px);
            background: var(--primary-color);
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        #boost-btn {
            background-color: rgba(55, 65, 81, 0.5);
            color: white;
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            width: clamp(70px, 12vw, 100px);
            height: clamp(70px, 12vw, 100px);
            border-radius: 50%;
            user-select: none; -webkit-user-select: none;
        }
    </style>
</head>
<body>
<div class="game-wrapper">
    <div class="game-container">
        <canvas id="gameCanvas"></canvas>
        
        <div class="ui-panel ui-element">
            <div>PONTOS: <span id="score">0</span></div>
            <div>VIVOS: <span id="snakes-alive">1</span></div>
        </div>

        <div id="leaderboard" class="ui-element">
            <h3>Classificação</h3>
            <ol id="leaderboard-list"></ol>
        </div>

        <div id="joystick-controls" class="mobile-controls">
            <div id="joystick-area"><div id="joystick"></div></div>
        </div>
        <div id="boost-controls" class="mobile-controls">
            <button id="boost-btn">⚡</button>
        </div>

        <div id="orientation-message" class="message-box">Por favor, rode o seu dispositivo para o modo paisagem.</div>
        <div id="gameOverMessage" class="message-box hidden">
            <h2>Fim de Jogo!</h2>
            <p id="finalScore"></p>
            <button id="restartButton">Jogar Novamente</button>
        </div>
    </div>
</div>

<script>
    // --- Configurações e Elementos do DOM ---
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    // ... (restantes elementos do DOM)
    const leaderboardList = document.getElementById('leaderboard-list');
    const scoreElement = document.getElementById('score');
    const snakesAliveElement = document.getElementById('snakes-alive');
    const gameOverMessage = document.getElementById('gameOverMessage');
    const finalScoreElement = document.getElementById('finalScore');
    const restartButton = document.getElementById('restartButton');
    const boostBtn = document.getElementById('boost-btn');
    const joystickArea = document.getElementById('joystick-area');
    const joystick = document.getElementById('joystick');
    const joystickControls = document.getElementById('joystick-controls');
    const boostControls = document.getElementById('boost-controls');
    const orientationMessage = document.getElementById('orientation-message');

    const NUM_BOTS = 15;
    const NUM_PELLETS = 250;
    const WORLD_WIDTH = 2500;
    const WORLD_HEIGHT = 2500;

    // --- Estado do Jogo ---
    let player, bots, pellets, particles;
    let gameInterval, isGameOver;
    let camera = { x: 0, y: 0, zoom: 1 };
    let keys = { ArrowLeft: false, ArrowRight: false, Space: false };
    let joystickActive = false;
    let joystickCenter = { x: 0, y: 0 };
    
    const BOT_NAMES = ["Ghost", "Viper", "Raptor", "Siren", "Jaws", "Spike", "Shadow", "Blaze", "Fury", "Titan", "Reaper", "Worm", "Doom", "Cobra", "Venom"];
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

    // --- Classes e Fábricas ---
    function createSnake(x, y, color, name) {
        return {
            name: name, body: [{ x, y }], angle: Math.random() * 2 * Math.PI,
            speed: 1.8, turnSpeed: 0.05, radius: 7, color: color, score: 0,
            isBoosting: false, attractionRadius: 60, attractionSpeed: 0.3
        };
    }

    function createParticle(x, y, color) {
        const angle = Math.random() * Math.PI * 2;
        const speed = Math.random() * 3 + 1;
        return {
            x, y, color,
            vx: Math.cos(angle) * speed,
            vy: Math.sin(angle) * speed,
            life: 60, // Duração em frames
            alpha: 1
        };
    }

    // --- Funções Principais do Jogo ---
    function startGame() {
        resizeCanvas();
        player = createSnake(WORLD_WIDTH / 2, WORLD_HEIGHT / 2, '#00ff00', 'Você');
        bots = [];
        const usedNames = [...BOT_NAMES];
        for (let i = 0; i < NUM_BOTS; i++) {
            const nameIndex = Math.floor(Math.random() * usedNames.length);
            const botName = usedNames.splice(nameIndex, 1)[0];
            bots.push(createSnake(
                Math.random() * WORLD_WIDTH,
                Math.random() * WORLD_HEIGHT,
                `hsl(${Math.random() * 360}, 100%, 75%)`, botName
            ));
        }
        pellets = [];
        for (let i = 0; i < NUM_PELLETS; i++) spawnPellet();
        particles = [];
        isGameOver = false;
        keys = { ArrowLeft: false, ArrowRight: false, Space: false };
        joystickActive = false;
        if (isMobile) {
            joystickControls.style.display = 'block';
            boostControls.style.display = 'block';
            joystick.style.transform = 'translate(-50%, -50%)';
        }
        checkOrientation();
        updateUI();
        gameOverMessage.classList.add('hidden');
        if (gameInterval) clearInterval(gameInterval);
        gameInterval = setInterval(gameLoop, 1000 / 60);
    }
    
    function gameLoop() {
        if (isGameOver) return;
        handleInput();
        updateAll();
        drawAll();
    }

    function updateAll() {
        updatePlayer();
        updateBots();
        updatePellets();
        updateParticles();
        updateCamera();
        checkCollisions();
    }

    function drawAll() {
        const width = window.innerWidth;
        const height = window.innerHeight;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        ctx.save();
        // Aplica a transformação da câmara
        ctx.translate(width / 2, height / 2);
        ctx.scale(camera.zoom, camera.zoom);
        if(player) ctx.translate(-player.body[0].x, -player.body[0].y);
        
        drawWorldBackground();
        pellets.forEach(p => drawCircle(p.x, p.y, p.radius, p.color));
        if (player) drawSnake(player);
        bots.forEach(drawSnake);
        particles.forEach(p => drawParticle(p));
        
        ctx.restore();
        
        // UI é desenhada por cima, sem transformação da câmara
        updateLeaderboard();
        updateUI();
    }

    // --- Lógica de Desenho ---
    function drawSnake(snake) {
        if (snake.body.length < 2) return;
        ctx.strokeStyle = snake.color;
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';

        for (let i = 0; i < snake.body.length - 1; i++) {
            const segment = snake.body[i];
            const nextSegment = snake.body[i + 1];
            // A espessura da cauda diminui
            ctx.lineWidth = snake.radius * 2 * (1 - i / snake.body.length);
            ctx.beginPath();
            ctx.moveTo(segment.x, segment.y);
            ctx.lineTo(nextSegment.x, nextSegment.y);
            ctx.stroke();
        }
    }
    
    function drawCircle(x, y, radius, color) { /* ... (sem alterações) ... */ }
    function drawParticle(p) {
        ctx.globalAlpha = p.alpha;
        drawCircle(p.x, p.y, 2, p.color);
        ctx.globalAlpha = 1;
    }
    function drawWorldBackground() { /* ... (sem alterações) ... */ }

    // --- Lógica de Atualização ---
    function handleInput() { /* ... (sem alterações) ... */ }
    function updatePlayer() { if (player) moveSnake(player); }
    function updateBots() { /* ... (sem alterações) ... */ }
    function moveSnake(snake) { /* ... (sem alterações) ... */ }
    function updatePellets() { /* ... (sem alterações) ... */ }
    function updateParticles() {
        for (let i = particles.length - 1; i >= 0; i--) {
            const p = particles[i];
            p.x += p.vx;
            p.y += p.vy;
            p.life--;
            p.alpha = p.life / 60;
            if (p.life <= 0) particles.splice(i, 1);
        }
    }
    function updateCamera() {
        if (!player) return;
        const targetZoom = 1 - (player.body.length / 800);
        camera.zoom = (camera.zoom || 1) * 0.98 + targetZoom * 0.02; // Zoom suave
    }

    // --- Colisões e Estado do Jogo ---
    function checkCollisions() { /* ... (sem alterações) ... */ }
    function killSnake(snake) {
        for (let i = 0; i < 30; i++) {
            particles.push(createParticle(snake.body[0].x, snake.body[0].y, snake.color));
        }
        snake.body.forEach((seg, i) => {
            if (i % 5 === 0) spawnPellet(seg.x, seg.y, 5, "#ffffff");
        });
        if (snake === player) {
            endGame(player ? player.score : 0);
            player = null;
        } else {
            const botIndex = bots.indexOf(snake);
            if (botIndex > -1) bots.splice(botIndex, 1);
        }
    }
    function endGame(score) {
        isGameOver = true;
        clearInterval(gameInterval);
        finalScoreElement.textContent = `Pontuação Final: ${score}`;
        gameOverMessage.classList.remove('hidden');
    }
    
    // --- Funções de UI e Auxiliares ---
    function updateLeaderboard() { /* ... (sem alterações) ... */ }
    function updateUI() { /* ... (sem alterações) ... */ }
    function checkOrientation() { /* ... (sem alterações) ... */ }
    function updateJoystick(touch) { /* ... (sem alterações) ... */ }
    function spawnPellet(x, y, value = 1, color) { /* ... (sem alterações) ... */ }
    function findClosestPellet(snake) { /* ... (sem alterações) ... */ }
    
    // --- Event Listeners ---
    window.addEventListener('resize', () => { resizeCanvas(); if (isMobile) checkOrientation(); });
    restartButton.addEventListener('click', startGame);
    // ... (restantes event listeners)

    // --- Código Compactado (sem alterações, para manter a funcionalidade) ---
    drawCircle=function(t,o,e,a){ctx.fillStyle=a,ctx.beginPath(),ctx.arc(t,o,e,0,2*Math.PI),ctx.fill()}
    drawWorldBackground=function(){ctx.strokeStyle="#33ff33",ctx.lineWidth=10,ctx.strokeRect(0,0,WORLD_WIDTH,WORLD_HEIGHT),ctx.strokeStyle="rgba(255, 255, 255, 0.03)",ctx.lineWidth=2;for(let t=0;t<=WORLD_WIDTH;t+=50)ctx.beginPath(),ctx.moveTo(t,0),ctx.lineTo(t,WORLD_HEIGHT),ctx.stroke();for(let t=0;t<=WORLD_HEIGHT;t+=50)ctx.beginPath(),ctx.moveTo(0,t),ctx.lineTo(WORLD_WIDTH,t),ctx.stroke()}
    handleInput=function(){player&&(isMobile||(keys.ArrowLeft&&(player.angle-=player.turnSpeed),keys.ArrowRight&&(player.angle+=player.turnSpeed)),player.isBoosting=keys.Space)}
    updateBots=function(){bots.forEach(t=>{if(!t.targetPellet||Math.random()<.005)t.targetPellet=findClosestPellet(t);if(t.targetPellet){const o=Math.atan2(t.targetPellet.y-t.body[0].y,t.targetPellet.x-t.body[0].x);t.angle+=Math.sign(o-t.angle)*t.turnSpeed*.5}moveSnake(t)})}
    moveSnake=function(t){const o=t.isBoosting?2*t.speed:t.speed,e=t.body[0],a={x:e.x+Math.cos(t.angle)*o,y:e.y+Math.sin(t.angle)*o};t.body.unshift(a);const s=15+t.score;for(;t.body.length>s&&t.body.length>2;)t.body.pop()}
    updatePellets=function(){const t=[player,...bots].filter(t=>t);pellets.forEach(o=>{o.vx*=.95,o.vy*=.95,t.forEach(t=>{if(t){const e=t.body[0],a=Math.hypot(o.x-e.x,o.y-e.y);if(a<t.attractionRadius){const s=e.x-o.x,n=e.y-o.y;o.vx+=s/a*t.attractionSpeed,o.vy+=n/a*t.attractionSpeed}}}),o.x+=o.vx,o.y+=o.vy})}
    checkCollisions=function(){const t=[player,...bots].filter(t=>t);for(let o=t.length-1;o>=0;o--){const e=t[o];if(e){const a=e.body[0];if(a.x<e.radius||a.x>WORLD_WIDTH-e.radius||a.y<e.radius||a.y>WORLD_HEIGHT-e.radius){killSnake(e);continue}for(let o=pellets.length-1;o>=0;o--){const t=pellets[o];Math.hypot(a.x-t.x,a.y-t.y)<e.radius+t.radius&&(e.score+=t.value,pellets.splice(o,1),spawnPellet())}for(let o=0;o<t.length;o++){const s=t[o];if(s)for(let n=0;n<s.body.length;n++){if(e===s&&n<4)continue;const i=s.body[n];if(Math.hypot(a.x-i.x,a.y-i.y)<e.radius){killSnake(e);break}}}}}}
    updateLeaderboard=function(){const t=[player,...bots].filter(t=>t);t.sort((t,o)=>o.score-t.score),leaderboardList.innerHTML="";const o=t.slice(0,5);o.forEach(t=>{const o=document.createElement("li"),e=document.createElement("span");e.textContent=t.name,t===player&&(e.style.color=player.color);const a=document.createElement("span");a.textContent=t.score,o.appendChild(e),o.appendChild(a),leaderboardList.appendChild(o)})}
    updateUI=function(){scoreElement.textContent=player?player.score:0,snakesAliveElement.textContent=bots.length+(player?1:0)}
    checkOrientation=function(){isMobile&&(window.innerWidth<window.innerHeight?(orientationMessage.style.display="block",gameInterval&&clearInterval(gameInterval)):(orientationMessage.style.display="none",!gameInterval&&!isGameOver&&(gameInterval=setInterval(gameLoop,1e3/60))))}
    updateJoystick=function(t){const o=t.clientX-joystickCenter.x,e=t.clientY-joystickCenter.y,a=joystickArea.clientWidth/2-joystick.clientWidth/2,s=Math.min(a,Math.hypot(o,e)),n=Math.atan2(e,o),i=s*Math.cos(n),l=s*Math.sin(n);joystick.style.transform=`translate(calc(-50% + ${i}px), calc(-50% + ${l}px))`,player&&s> .2*a&&(player.angle=n)}
    spawnPellet=function(t,o,e=1,a){pellets.push({x:t||Math.random()*WORLD_WIDTH,y:o||Math.random()*WORLD_HEIGHT,radius:e>1?4:2,value:e,color:a||`hsl(${360*Math.random()}, 100%, 50%)`,vx:0,vy:0})}
    findClosestPellet=function(t){let o=null,e=1/0;return pellets.forEach(a=>{const s=Math.hypot(t.body[0].x-a.x,t.body[0].y-a.y);s<e&&(e=s,o=a)}),o}
    if(!isMobile){document.addEventListener("keydown",t=>{"ArrowLeft"in keys||"ArrowRight"in keys||"Space"in keys?(t.preventDefault(),keys[t.code]=!0):"ArrowUp"in keys&&"ArrowDown"in keys&&(t.preventDefault(),keys[t.code]=!0)}),document.addEventListener("keyup",t=>{"ArrowLeft"in keys||"ArrowRight"in keys||"Space"in keys?(t.preventDefault(),keys[t.code]=!1):"ArrowUp"in keys&&"ArrowDown"in keys&&(t.preventDefault(),keys[t.code]=!1)})}else{joystickArea.addEventListener("touchstart",t=>{t.preventDefault();const o=t.touches[0],e=joystickArea.getBoundingClientRect();joystickCenter={x:e.left+e.width/2,y:e.top+e.height/2},joystickActive=!0,joystickArea.classList.add("active"),updateJoystick(o)}),joystickArea.addEventListener("touchmove",t=>{t.preventDefault(),joystickActive&&updateJoystick(t.touches[0])}),joystickArea.addEventListener("touchend",t=>{t.preventDefault(),joystickActive=!1,joystickArea.classList.remove("active"),joystick.style.transform="translate(-50%, -50%)"}),boostBtn.addEventListener("touchstart",t=>{t.preventDefault(),keys.Space=!0}),boostBtn.addEventListener("touchend",t=>{t.preventDefault(),keys.Space=!1})}

    // --- Inicialização ---
    startGame();
</script>
</body>
</html>
